<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Advanced Phishing Email Detector (Client‚ÄëSide)</title>
  <meta name="description" content="A safe, client‚Äëside phishing email detector UI. Paste an email and get a quick risk analysis. No data is uploaded." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #0b1020;
      --panel: #0f172a;
      --card: #0b1220;
      --border: #1f2a44;
      --muted: #93a3be;
      --text: #e7edf7;
      --blue: #2563eb;
      --blue-2: #3b82f6;
      --green: #22c55e;
      --red: #ef4444;
      --amber: #f59e0b;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:radial-gradient(1000px 600px at 10% -10%, #1e3a8a22, transparent),
                     radial-gradient(900px 500px at 120% 0%, #15803d22, transparent),
                     var(--bg);color:var(--text);font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    h1{font-size:28px;margin:8px 0 14px;display:flex;align-items:center;gap:10px}
    .subtitle{color:var(--muted);margin-bottom:16px}
    .shield{width:28px;height:28px;display:inline-block;background:conic-gradient(from 180deg, #67e8f9, #60a5fa, #818cf8);border-radius:8px}

    .grid{display:grid;gap:18px}
    @media (min-width: 960px){.grid{grid-template-columns: 1.1fr 1fr}}

    .card{background:linear-gradient(180deg,#0b1426,#0a1221);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
    .card h3{margin:4px 0 12px;font-size:16px}

    label{display:block;font-size:13px;color:#b6c4da;margin-bottom:6px}
    input[type="text"], textarea{width:100%;padding:11px 12px;border-radius:12px;border:1px solid var(--border);background:#07101f;color:var(--text)}
    textarea{min-height:160px;resize:vertical}

    .row{display:grid;gap:12px}
    .btns{display:flex;gap:10px;align-items:center}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:10px;border:none;padding:11px 14px;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.2)}
    .btn.primary{background:linear-gradient(180deg,var(--blue-2),#1d4ed8);color:white}
    .btn.ghost{background:#0b2233;color:#9bd7ff;border:1px solid #1e3a5f}

    .empty{border:2px dashed #334155;border-radius:14px;color:#94a3b8;display:flex;align-items:center;justify-content:center;min-height:200px;text-align:center;padding:20px}

    .badge{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;background:#08263b;border:1px solid #134063;color:#9bd7ff;font-size:12px}

    .list{list-style:none;margin:0;padding:0}
    .list .item{display:flex;flex-direction:column;gap:2px;border:1px solid var(--border);background:#0b1a2b;border-radius:12px;padding:10px;margin-top:10px}
    .item .title{font-weight:700}
    .item .muted{color:#9fb0c9;font-size:13px}

    .score{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .score .level{font-weight:800;padding:6px 10px;border-radius:999px}
    .level.low{background:#10b98133;color:#86efac;border:1px solid #10b98155}
    .level.medium{background:#f59e0b33;color:#fde68a;border:1px solid #f59e0b55}
    .level.high{background:#ef444433;color:#fecaca;border:1px solid #ef444455}
    .bar{height:8px;background:#0f172a;border-radius:999px;overflow:hidden}
    .bar>span{display:block;height:100%;background:linear-gradient(90deg,#ef4444,#f59e0b,#22c55e)}

    .kpi{display:grid;grid-template-columns: repeat(3, 1fr); gap:8px;margin-top:10px}
    .pill{background:#0b2233;border:1px solid #1e3a5f;color:#9bd7ff;padding:4px 8px;border-radius:999px;font-size:12px;text-align:center}

    .finding{display:flex;gap:8px;align-items:flex-start;border:1px solid var(--border);border-left-width:4px;border-radius:10px;padding:8px;margin-top:8px}
    .finding.low{border-left-color:#22c55e}
    .finding.medium{border-left-color:#f59e0b}
    .finding.high{border-left-color:#ef4444}
    .finding .extra{color:#9fb0c9;font-size:12px}

    .footer{margin-top:20px;color:#94a3b8;font-size:12px}
  </style>
</head>
<body>
  <div class="container">
    <header style="text-align:center">
      <h1><span class="shield"></span> Advanced Phishing Email Detector</h1>
      <div class="subtitle">Analyze emails for phishing indicators using client‚Äëside detection. Nothing is uploaded.</div>
    </header>

    <div class="grid">
      <!-- LEFT: INPUTS -->
      <section class="card">
        <h3>üìß Email Analysis</h3>
        <div class="row">
          <label>Sender Email
            <input id="sender" type="text" placeholder="sender@example.com" autocomplete="off" />
          </label>
          <label>Subject Line
            <input id="subject" type="text" placeholder="Email subject" autocomplete="off" />
          </label>
          <label>Email Content
            <textarea id="content" placeholder="Paste the email content here..."></textarea>
          </label>
        </div>
        <div class="btns" style="margin-top:12px">
          <button id="analyze" class="btn primary">‚ö° Analyze Email</button>
          <button id="clear" class="btn ghost">Clear</button>
        </div>

        <div style="margin-top:18px">
          <div class="badge">Sample Emails</div>
          <ul class="list" id="samples"></ul>
        </div>
      </section>

      <!-- RIGHT: RESULTS -->
      <section class="card">
        <h3>üß≠ Results</h3>
        <div id="empty" class="empty">
          <div>
            <div style="font-size:18px;font-weight:700">No Analysis Yet</div>
            <div style="margin-top:6px">Enter an email on the left and click <strong>‚ÄúAnalyze Email‚Äù</strong> to see detailed results.</div>
          </div>
        </div>
        <div id="results" style="display:none">
          <div class="score">
            <div id="level" class="level low">LOW</div>
            <div style="flex:1">
              <div class="bar"><span id="bar" style="width:0%"></span></div>
              <div style="font-size:12px;color:#9fb0c9;margin-top:4px">Risk score: <span id="score">0</span>/100</div>
            </div>
          </div>

          <div class="kpi">
            <div class="pill" id="kpi-links">0 links</div>
            <div class="pill" id="kpi-keywords">0 risky keywords</div>
            <div class="pill" id="kpi-attachments">0 risky attachments</div>
          </div>

          <div style="margin-top:10px">
            <div style="font-weight:700;margin-bottom:6px">Findings</div>
            <div id="findings"></div>
          </div>
        </div>
      </section>
    </div>

    <div class="footer">For awareness and initial triage only. This does not replace secure email gateways or DFIR processes.</div>
  </div>

  <script>
    // ===== Utilities =====
    const $ = (sel) => document.querySelector(sel);

    const SAMPLES = [
      {
        id: 'phish-pp',
        title: 'Phishing Example',
        subtitle: 'PayPal account suspension scam',
        data: {
          sender: 'service@paypal.com.secure-notice.co',
          subject: 'Your account will be suspended in 24 hours',
          content: `Dear Customer,\n\nWe detected suspicious activity. To avoid suspension please reconfirm your account now:\nhttps://paypal.com.secure-notice.co/verify\n\nAlternatively, visit http://198.51.100.23/pp-update\n\nFailure to act immediately will lead to permanent closure.\n\nAttachment: invoice.zip`,
        }
      },
      {
        id: 'legit-gh',
        title: 'Legitimate Example',
        subtitle: 'GitHub security notification',
        data: {
          sender: 'noreply@github.com',
          subject: '[GitHub] New sign-in from Chrome on macOS',
          content: `We noticed a new sign-in to your GitHub account from Chrome on macOS.\nIf this was you, no action is needed. If not, please review your account activity: https://github.com/settings/security-log`,
        }
      }
    ];

    function renderSamples(){
      const root = $('#samples');
      root.innerHTML = '';
      SAMPLES.forEach(s => {
        const li = document.createElement('li');
        li.className = 'item';
        li.innerHTML = `<div class="title">${s.title}</div><div class="muted">${s.subtitle}</div>`;
        li.addEventListener('click', () => loadSample(s.data));
        root.appendChild(li);
      });
    }

    function loadSample(data){
      $('#sender').value = data.sender || '';
      $('#subject').value = data.subject || '';
      $('#content').value = data.content || '';
      analyze();
      window.scrollTo({top:0, behavior:'smooth'});
    }

    // ===== Analysis logic (client‚Äëside only) =====
    function extractUrls(text){
      const regex = /\b((?:https?:\/\/)?[\w.-]+(?:\.[a-z]{2,})(?::\d+)?(?:\/[\w\-._~:/?#[\]@!$&'()*+,;=%]*)?)/gi;
      return Array.from(new Set(text.match(regex) || [])).slice(0,50);
    }
    function hostname(u){
      try{ const withScheme = /^https?:\/\//i.test(u) ? u : `http://${u}`; return new URL(withScheme).hostname.toLowerCase(); }catch{ return null; }
    }
    function isIPHost(h){ return /^(?:\d{1,3}\.){3}\d{1,3}$/.test(h); }
    function hasPunycode(h){ return h.split('.').some(x=>x.startsWith('xn--')); }
    function endsWithAny(h, list){ return list.some(d => h.endsWith(d)); }
    function urgencySignals(s){
      const words = ['urgent','immediately','expire','action required','verify','final notice','suspended','24 hours','password reset','confirm account','mfa code','gift card','wire transfer'];
      return words.filter(w => new RegExp(w.replace(/\s+/g,'\\s+'),'i').test(s));
    }

    function analyze(){
      const sender = $('#sender').value.trim();
      const subject = $('#subject').value.trim();
      const content = $('#content').value.trim();

      const findings = [];
      let score = 0;

      // Sender checks
      const senderDomain = (sender.match(/@([^>\s]+)$/) || [,''])[1].toLowerCase();
      if (!sender){ findings.push(f('high','Missing sender email')); score += 12; }
      if (sender && !/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(sender)){ findings.push(f('high','Sender email format looks invalid', sender)); score += 12; }

      // Links
      const urls = extractUrls(content + ' ' + subject);
      let riskyLinkCount = 0;
      const suspiciousTlds = ['.zip','.mov','.country','.gq','.tk','.ml','.cf'];
      const orgDomains = []; // optionally add your domains here
      urls.forEach(u => {
        const h = hostname(u); if (!h) return;
        if (!/^https:\/\//i.test(u)){ findings.push(f('medium','Non‚ÄëHTTPS link', u)); score += 6; riskyLinkCount++; }
        if (isIPHost(h)){ findings.push(f('high','Link uses IP address', u)); score += 12; riskyLinkCount++; }
        if (hasPunycode(h)){ findings.push(f('high','Punycode/IDN host detected', h)); score += 12; riskyLinkCount++; }
        if (!endsWithAny(h, orgDomains) && !/paypal\.com$|github\.com$/i.test(h)){
          findings.push(f('medium','External domain', h)); score += 6; riskyLinkCount++;
        }
        if (suspiciousTlds.some(t => h.endsWith(t))){ findings.push(f('medium','Suspicious TLD', h)); score += 6; riskyLinkCount++; }
      });

      // Content signals
      const urg = urgencySignals((subject + ' ' + content).toLowerCase());
      if (urg.length){ findings.push(f('medium','Urgency/pressure language', urg.join(', '))); score += 6; }
      if (/password|verify|gift card|bitcoin|wire transfer|mfa|otp/i.test(content)){
        findings.push(f('medium','Sensitive request keywords present')); score += 6;
      }
      if (/\u200B|\u200C|\u200D|\u2060/.test(content)){
        findings.push(f('medium','Zero‚Äëwidth characters detected (possible obfuscation)')); score += 6;
      }

      // Attachments (naive: look for words like filename.ext inside content)
      const attachmentRegex = /\b[\w-]+\.(?:html?|exe|scr|js|jar|bat|cmd|vbs|ps1|lnk|iso|img|zip|rar|7z)\b/ig;
      const atts = Array.from(new Set(content.match(attachmentRegex) || []));
      let riskyAttCount = 0;
      atts.forEach(a => {
        const high = /\.(exe|js|scr|bat|cmd|vbs|ps1|jar)$/i.test(a);
        findings.push(f(high?'high':'medium', `Attachment reference: ${a}`));
        score += high ? 12 : 6; riskyAttCount++;
      });

      // Calculate level
      score = Math.max(0, Math.min(100, score));
      const level = score >= 50 || findings.some(x=>x.sev==='high') ? 'high' : score >= 20 ? 'medium' : 'low';

      // Render
      $('#empty').style.display = 'none';
      $('#results').style.display = '';
      const levelEl = $('#level');
      levelEl.className = `level ${level}`;
      levelEl.textContent = level.toUpperCase();
      $('#bar').style.width = score + '%';
      $('#score').textContent = score;
      $('#kpi-links').textContent = `${urls.length} link${urls.length!==1?'s':''}`;
      $('#kpi-keywords').textContent = `${urg.length} risky keyword${urg.length!==1?'s':''}`;
      $('#kpi-attachments').textContent = `${riskyAttCount} risky attachment${riskyAttCount!==1?'s':''}`;

      const list = $('#findings');
      list.innerHTML = '';
      if (!findings.length) list.innerHTML = '<div class="finding low">No issues detected. Stay vigilant and verify via trusted channels.</div>';
      findings.forEach(item => list.appendChild(renderFinding(item)));
    }

    function f(sev,msg,extra){ return { sev, msg, extra }; }

    function renderFinding({sev,msg,extra}){
      const div = document.createElement('div');
      div.className = `finding ${sev}`;
      const emoji = sev==='high'?'\u26A0\uFE0F':sev==='medium'?'\u26A0\uFE0F':'\u2705';
      div.innerHTML = `<div>${emoji}</div><div><div>${msg}</div>${extra?`<div class="extra">${escapeHtml(extra)}</div>`:''}</div>`;
      return div;
    }

    function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c])); }

    // Wire up UI
    $('#analyze').addEventListener('click', analyze);
    $('#clear').addEventListener('click', ()=>{
      $('#sender').value='';$('#subject').value='';$('#content').value='';
      $('#results').style.display='none';$('#empty').style.display='';
    });

    renderSamples();
  </script>
</body>
</html>
